{% extends 'flatpages/default.html' %}
{% load custom_filters %}

{% block title %}
    {{ news_detail.title }}
{% endblock %}

{% block content %}
    <h1>{{ news_detail.title|censor }}</h1>
    <hr>

    <!-- Отображение категорий -->
    {% if news_detail.categories.exists %}
        <h3>Категории:</h3>
        <ul>
        {% for category in news_detail.categories.all %}
            <li>{{ category.name }}
                {% if user.is_authenticated %}
                    {% if user in category.subscribers.all %}
                        <span>(Вы подписаны)</span>
                    {% else %}
                        <form action="{% url 'subscribe_to_category' category.id %}" method="post" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit">Подписаться</button>
                        </form>
                    {% endif %}
                {% endif %}
            </li>
        {% endfor %}
        </ul>
    {% endif %}

    <p><strong>Дата публикации:</strong> {{ news_detail.created_at|date:"d.m.Y H:i" }}</p>
    <hr>
    <p>{{ news_detail.text|censor }}</p>
    <br>
{% endblock %}
